// Generated by CoffeeScript 1.6.2
var SwingReceiver, Swinger, getTokenFromUrl, receiver, socket, swinger, token;

socket = io.connect("/");

receiver = null;

getTokenFromUrl = function() {
  if (window.location.href.indexOf("#") === -1) {
    alert("please specify a token");
    return false;
  } else {
    return window.location.href.split("#")[1];
  }
};

token = getTokenFromUrl();

if (token) {
  socket.on("connect", function() {
    return socket.emit('token', token);
  });
  socket.on("message", function(data) {
    if (typeof data === "object") {
      return receiver.send(data);
    } else {
      return console.log(data);
    }
  });
}

Swinger = (function() {
  function Swinger(playerId, token) {
    this.playerId = playerId;
    this.token = token;
  }

  Swinger.prototype.swing = function() {
    return socket.emit("swing", new SwingMessage(this.playerId, new Date().getTime(), this.token));
  };

  return Swinger;

})();

SwingReceiver = (function() {
  function SwingReceiver(callback) {
    this.callback = callback;
    receiver = this;
  }

  SwingReceiver.prototype.send = function(swing) {
    return this.callback(swing);
  };

  return SwingReceiver;

})();

receiver = new SwingReceiver(function(swing) {
  return console.log("swing received! " + swing);
});

swinger = new Swinger(1, token);
